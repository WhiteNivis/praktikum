# [Прогнозирование оттока клиентов в сети отелей](https://github.com/WhiteNivis/praktikum/tree/main/07-Система%20прогнозирования%20продажи%20отелей)

Заказчик этого исследования — сеть отелей «Как в гостях».
Чтобы привлечь клиентов, эта сеть отелей добавила на свой сайт возможность забронировать номер без предоплаты. Однако если клиент отменяет бронирование, то компания терпит убытки. Чтобы решить эту проблему, нужно разработать систему, которая предскажет отказ от брони. 

<font color='green'>Цель</font>

Проанализировать изменение прибыли после внедрения системы депозитов. Система депозитов базируется на модели машинного обучения, предсказывающей отмену заказа.  

<font color='green'>Задачи</font>

- исследовать данные;
- рассчитать прибыль до внедрения новой системы;
- построить модель машинного обучения;
- рассчитать прибыль после внедрения новой системы;
- определить портрет потенциального неплательщика.

<font color='green'>Основные условия</font>

- бюджет  - 400 тыс. руб.
- стоимость номера и разового обслуживания:

 * A: 1000 + 400
 * B:  800 + 350 
 * C:  600 + 350 
 * D:  550 + 150 
 * E:  500 + 150 
 * F:  450 + 150 
 * G:  350 + 150 

- ценовая политика: +20% весной и осенью, +40% летом.

<font color='green'>Файлы</font>

- `hotel_train.csv`
- `hotel_test.csv`

<font color='green'>Признаки</font>

-    `id` — номер записи;
-    `adults` — количество взрослых постояльцев;
-    `arrival_date_year` — год заезда;
-    `arrival_date_month` — месяц заезда;
-    `arrival_date_week_number` — неделя заезда;
-    `arrival_date_day_of_month` — день заезда;
-    `babies` — количество младенцев;
-    `booking_changes` — количество изменений параметров заказа;
-    `children` — количество детей от 3 до 14 лет;
-    `country` — гражданство постояльца;
-    `customer_type` — тип заказчика:
    *        `Contract` — договор с юридическим лицом;
    *        `Group` — групповой заезд;
    *        `Transient` — не связано с договором или групповым заездом;
    *        `Transient-party` — не связано с договором или групповым заездом, но связано с бронированием типа Transient.
-    `days_in_waiting_list` — сколько дней заказ ожидал подтверждения;
-    `distribution_channel` — канал дистрибуции заказа;
-    `is_repeated_guest` — признак того, что гость бронирует номер второй раз;
-    `lead_time` — количество дней между датой бронирования и датой прибытия;
-    `meal` — опции заказа:
    *        `SC` — нет дополнительных опций;
    *        `BB` — включён завтрак;
    *        `HB` — включён завтрак и обед;
    *        `FB` — включён завтрак, обед и ужин.
-    `previous_bookings_not_canceled` — количество подтверждённых заказов у клиента;
-    `previous_cancellations` — количество отменённых заказов у клиента;
-    `required_car_parking_spaces` — необходимость места для автомобиля;
-    `reserved_room_type` — тип забронированной комнаты;
-    `stays_in_weekend_nights` — количество ночей в выходные дни;
-    `stays_in_week_nights` — количество ночей в будние дни;
-    `total_nights` — общее количество ночей;
-    `total_of_special_requests` — количество специальных отметок.

<font color='green'>Целевой признак</font>

- `is_canceled` — отмена заказа.

<font color='green'>Содержание</font>


## Общий вывод

Рабочей моделью для предсказания отмены заказа признана модель `"Дерево решений"` без применения балансировки классов и следующими параметрами:

	DecisionTreeClassifier(max_depth=4, min_samples_leaf=8, random_state=12345)

`'f1'` модели на кросс-валидации - 0.633, на тесте - 0.617.


Значение прибыли до внедрения модели: `49,10` млн. руб.

Значение прибыли после внедрения модели: `57,54` млн. руб (* без учета возможного падения спроса и налогов)

Портрет потенциально ненадежного клиента:
   
   - наличие ранее отмененных заказов (`'previous_cancellations'`)
   - большое кол-во дней между датой бронирования и датой прибытия (`'lead_time'`)
   - тип заказчика `Transient`(`'customer_type'`)
   - отсутствие специальных отметок в заказе (`'total_of_special_requests'`)
   
   
   - общее кол-во ночей: 2-3 среди недели (`'total_nights'`, `'stays_in_weekend_nights'`)
   - дата прибытия: апрель-июнь (`'arrival_date_month'`)    


